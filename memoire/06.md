# 6. Maintenance corrective

La maintenance corrective d'AQUAREEL constitue un pilier essentiel de notre prestation de TMA. Elle vise à corriger rigoureusement les anomalies non détectées lors des phases de recette, en s'appuyant sur un processus structuré et traçable, adapté aux exigences d'une application critique de sécurité civile.

## 6.1. Processus de maintenance corrective

Notre processus de maintenance corrective s'articule autour de quatre phases successives, complétées par un workflow de suivi commun et des règles d'escalade :

### 6.1.1. Déclaration et qualification

Toute anomalie est déclarée via la plateforme de suivi mise en place lors de la phase d'initialisation. Cette plateforme centralisée permet :

- La saisie structurée des anomalies par les gestionnaires des services utilisateurs
- Le suivi en temps réel de l'état de traitement
- La traçabilité complète du cycle de vie de l'anomalie
- L'historisation de l'ensemble des interventions

Conformément au CCTP, les anomalies sont qualifiées selon trois niveaux de criticité :

**Anomalie bloquante** : empêche l'utilisation de l'application (absence de collecte, indisponibilité de l'alimentation de la base nationale PHyC). Ces anomalies sont transmises immédiatement et font l'objet d'une intervention sous 2 jours ouvrés.

**Anomalie majeure** : certaines fonctions importantes ne sont plus accessibles (dysfonctionnement du système d'alarmes hydrologiques). Ces anomalies sont transmises immédiatement et font l'objet d'une intervention sous 2 jours ouvrés.

**Anomalie mineure** : l'application reste fonctionnelle malgré l'impact sur une fonction secondaire. Ces anomalies sont regroupées et traitées par lot, sans dépasser un délai d'un mois.

### 6.1.2. Diagnostic et analyse

Le diagnostic initial est pris en charge sur le forfait support annuel de 15 jours. Pour les interventions non urgentes, le délai de qualification est fixé à 1 semaine.

Notre méthodologie de diagnostic repose sur :

**Reproduction systématique de l'anomalie** : nous mettons en œuvre les données et les étapes fournies par le maître d'ouvrage sur la plateforme de test du titulaire en configuration HD. Cette étape vise à obtenir une compréhension complète du dysfonctionnement avant toute intervention.

**Analyse de l'origine** : nous procédons à une analyse méthodique pour identifier la cause racine :
- Analyse des traces applicatives (journaux Windows, journaux SQL Server, traces de l'application)
- Consultation des logs de supervision et de maintenance BDD
- Examen du journal de bord pour identifier les événements corrélés
- Analyse du code source des composants concernés
- Vérification de la cohérence du modèle de données

**Évaluation de l'impact** : nous déterminons précisément le périmètre fonctionnel et technique impacté :
- Composants applicatifs concernés (services, base de données, clients)
- Fonctionnalités affectées (collecte, échanges, alarmes, supervision)
- Compatibilité avec l'architecture haute disponibilité
- Impact sur la réplication SQL Server

**Proposition de solution** : nous présentons au maître d'ouvrage un rapport de diagnostic comprenant :
- La description de la cause identifiée
- La solution de correction proposée
- L'estimation de la charge de correction
- Les impacts prévisibles sur l'existant
- Le cas échéant, une solution de contournement provisoire

### 6.1.3. Correction et tests internes

Une fois la solution validée par le maître d'ouvrage, nous procédons à la correction en respectant scrupuleusement les principes de développement AQUAREEL :

**Correction minimale** : conformément aux bonnes pratiques de maintenance, nous limitons strictement l'intervention au périmètre nécessaire. Nous ne modifions que les composants impactés par l'anomalie, sans réaliser de refactoring ou d'amélioration hors périmètre. Cette approche vise à préserver la stabilité de l'application.

**Respect de l'architecture existante** : nous maintenons la cohérence avec l'existant :
- Respect des normes et conventions de nommage en place
- Utilisation des fonctions applicatives du SGBDR (procédures stockées, triggers, jobs)
- Conformité au modèle de données MERISE
- Respect des règles d'optimisation SQL (limitation des fonctions scalaires et curseurs)
- Maintien de la compatibilité avec la réplication transactionnelle

**Tests unitaires et d'intégration** : chaque correction fait l'objet de tests rigoureux sur la plateforme de test du titulaire en configuration HD :
- Tests unitaires du composant corrigé
- Tests d'intégration avec les modules connexes
- Vérification du comportement en configuration unitaire et HD
- Tests de la compatibilité avec la réplication SQL Server

**Tests de non-régression** : point essentiel de notre approche, nous exécutons une campagne de tests de non‑régression, automatisée (base + applicatif) sur un jeu de données de référence, et complétée si nécessaire par des contrôles manuels ciblés, afin de détecter d'éventuelles régressions avant livraison. Un rapport de tests est produit et transmis au maître d'ouvrage avec chaque livraison (cf. Annexe A.2). Nous rejouons notamment les scénarios de test concernant :
- Les fonctionnalités directement impactées par la correction
- Les fonctionnalités connexes utilisant les mêmes composants
- Les fonctionnalités critiques de l'application (collecte, alarmes, exports)

Pour les corrections concernant la collecte radio, nous utilisons la plateforme de test du SPC Grand Delta à Privas, accessible à distance, pour valider le fonctionnement réel avec les périphériques radio.

### 6.1.4. Livraison et déploiement

Conformément au paragraphe 3.2 du CCTP, chaque correction fait l'objet d'une livraison de mise à jour comprenant :

**Document de traçabilité des modifications** : ce document décrit exhaustivement les modifications apportées par rapport à la version de référence :
- Référence de l'anomalie corrigée
- Description détaillée de la correction réalisée
- Liste des composants modifiés (procédures stockées, services, vues, jobs, modules)
- Impacts sur le modèle de données (le cas échéant)
- Instructions spécifiques de déploiement

**Rapport de tests de non‑régression** : ce rapport synthétise la campagne de tests exécutée (tests automatisés et, le cas échéant, contrôles manuels ciblés), les résultats obtenus et les points de vigilance associés.

**Setup d'installation des mises à jour** : nous fournissons un package d'installation automatisée comprenant :
- Les exécutables et assemblies modifiés
- Les scripts SQL de mise à jour de la base de données
- Les fichiers de configuration mis à jour
- Les contrôles de version préalables au déploiement

**Document de procédure d'installation** : ce document détaille pas à pas la procédure de déploiement :
- Prérequis et vérifications préalables
- Étapes d'installation séquentielle
- Vérifications post-installation
- Procédure de rollback en cas d'incident
- Points de vigilance spécifiques à la configuration HD

**Documentation impactée mise à jour** : nous mettons à jour les documents techniques concernés :
- Manuel d'exploitation (si la correction modifie des procédures d'exploitation)
- Manuel utilisateur (si la correction impacte l'interface utilisateur)
- Manuel d'installation (si la correction modifie les prérequis ou la procédure)
- Modèle de données (si la correction modifie la structure de la base)

**Code source mis à jour** : nous livrons le code source des composants modifiés, versionnés et documentés selon les standards AQUAREEL.

**Modalités de déploiement** : conformément aux pratiques décrites dans le DCE, la mise en production est réalisée par les administrateurs sur chaque site. Le titulaire fournit les setups, les scripts et les procédures, et peut assister à distance (dans les conditions d'accès prévues) pour sécuriser l'opération.

**Critères de clôture (Definition of Done)** : un correctif est proposé à la clôture lorsque :
- la correction est versionnée, traçable et reliée au ticket ;
- les scripts SQL et le package de mise à jour sont fournis ;
- la procédure d'installation et la procédure de rollback sont à jour ;
- la campagne de tests (unitaires, intégration, non‑régression, HD si applicable) a été exécutée ;
- le rapport de tests de non‑régression est joint à la livraison (cf. Annexe A.2) ;
- la documentation impactée est mise à jour (si applicable) ;
- les points de vigilance sont explicités (pré‑requis, impacts, surveillance post‑déploiement).

Les modèles de livrables correspondants (note de livraison, rapport de tests, rapport d'intervention urgente, RCA) sont fournis en Annexe A (A.1, A.2, A.3, A.5).

### 6.1.5. Workflow de suivi (tickets) et règles d'escalade

Le titulaire s'appuie en priorité sur le workflow de la plateforme de suivi retenue par le Service Central Vigicrues. À défaut, un workflow simple et lisible est proposé, avec a minima les statuts suivants :

| Statut | Finalité | Sortie attendue |
|--------|----------|-----------------|
| Ouvert | Enregistrer la demande et compléter les informations | Accusé de prise en compte, demande de compléments si nécessaire |
| Qualifié | Confirmer la reproduction, la criticité et le périmètre | Diagnostic initial, estimation et plan d'action |
| En cours | Réaliser la correction et les tests internes | Points d'avancement tracés dans le ticket |
| Prêt à livrer | Préparer la livraison | Package, procédure, rapport de tests |
| Livré | Transmettre et accompagner le déploiement | Note de livraison, points de vigilance |
| Validé / Clos | Clôturer après validation | Ticket clos, REX si nécessaire |

**Règles d'escalade et communication**
- En cas de demande urgente : double canal (ticket + appel) pour accélérer la prise en compte tout en conservant la traçabilité.
- En cas de risque sur un délai contractuel ou de blocage technique : information explicite dans le ticket et alerte du maître d'ouvrage, avec options (contournement, phasage, priorisation).
- En cas d'impact transversal (HD, réplication, collecte, diffusion) : information coordonnée avec le SPC Grand Delta, afin d'aligner le diagnostic et les actions.

## 6.2. Compatibilité haute disponibilité

Toute correction doit être compatible avec l'architecture haute disponibilité d'AQUAREEL. Nous vérifions systématiquement :

**Compatibilité avec la réplication transactionnelle** : toute modification du modèle de données est testée pour s'assurer de sa compatibilité avec la réplication SQL Server entre le site actif et les sites passifs. Nous nous assurons que :
- Les modifications de schéma sont réplicables
- Les triggers et procédures stockées fonctionnent correctement en contexte de réplication
- Les jobs de maintenance n'interfèrent pas avec la réplication

**Maintien de la cohérence multi-sites** : nous vérifions que la correction fonctionne correctement :
- Sur le site actif et les sites passifs
- Lors des basculements manuels ou automatiques
- Lors de la prise en charge des tâches en secours par le site passif
- Dans le cadre de la supervision inter-sites

**Tests en configuration HD** : la plateforme de test du titulaire reproduit la configuration HD (2 sites de concentration + 1 site de surveillance) pour valider le comportement de chaque correction dans ce contexte.

## 6.3. Traçabilité et documentation

La traçabilité complète de chaque correction est assurée par :

**Plateforme de suivi** : chaque anomalie est tracée depuis sa déclaration jusqu'à sa résolution :
- Horodatage de chaque étape (déclaration, qualification, diagnostic, correction, livraison)
- Échanges entre le titulaire et le maître d'ouvrage
- Documents produits (rapport de diagnostic, document de traçabilité)
- Temps passé (décompte du forfait support ou facturation en maintenance corrective)

**Gestion de configuration** : nous maintenons un référentiel de versions complet :
- Gestion du code source sous Git
- Identification unique de chaque livraison
- Traçabilité des modifications apportées à chaque composant
- Possibilité de reconstituer l'historique complet de l'application

**Rapports d'intervention** : chaque correction fait l'objet d'un rapport d'intervention décrivant (cf. Annexe A.3) :
- Le diagnostic réalisé
- La solution mise en œuvre
- Les tests effectués
- Les résultats de validation
- Les éventuelles recommandations

## 6.4. Organisation et interlocuteurs

L'organisation du support technique, décrite au paragraphe 6.1 du CCTP, repose sur deux niveaux :

**Premier niveau : SPC Grand Delta** : pour les demandes de support « métier », le SPC Grand Delta assure le premier niveau de support. Il traite les demandes des gestionnaires et transmet au titulaire les demandes nécessitant une intervention technique.

**Second niveau : Titulaire** : nous intervenons pour :
- Les interventions urgentes (blocages ou dysfonctionnements majeurs)
- La qualification des anomalies (diagnostic et proposition de solution)
- La maintenance corrective proprement dite (correction et livraison)

Toutes les demandes sont saisies via la plateforme de suivi. Les demandes urgentes font l'objet d'un double canal : saisie sur la plateforme et appel téléphonique direct.

## 6.5. Forfait support et facturation

Le forfait support annuel de 15 jours, commun à tous les utilisateurs et pris en charge par le Service Central Vigicrues, couvre :

- Les interventions urgentes (diagnostic et résolution rapide sous 1 journée, solution définitive ou de contournement)
- La qualification des anomalies (diagnostic et proposition de solution dans le cadre de la maintenance corrective)

Nous informons au fil de l'eau le maître d'ouvrage des interventions décomptées sur ce forfait, permettant un suivi transparent de la consommation.

Les prestations de correction proprement dites (conception, développement, tests internes, livraison, mise à jour de la documentation) font l'objet de bons de commande établis sur la base du bordereau des prix unitaires.

## 6.6. Délais et engagements

Nous nous engageons à respecter les délais suivants :

| Type d'anomalie | Délai d'intervention | Modalité |
|-----------------|---------------------|----------|
| Bloquante | 2 jours ouvrés | Intervention immédiate après transmission |
| Majeure | 2 jours ouvrés | Intervention immédiate après transmission |
| Mineure | Regroupement par lot | Sans dépasser 1 mois |
| Intervention urgente | 1 jour ouvré | À compter de la réception de la demande |
| Qualification | 1 semaine | Pour les interventions non urgentes |

Par « délai d'intervention », nous entendons le démarrage effectif du diagnostic et la communication au maître d'ouvrage d'un premier retour sur l'anomalie (reproduction confirmée, pistes identifiées, délai estimé de correction).

**Définitions complémentaires**
- **Délai de qualification** : reproduction confirmée, criticité validée, et premiers éléments de diagnostic/estimation communiqués.
- **Délai de correction** : livraison d'une solution (définitive ou de contournement) selon le cadrage validé.
- **Délai de résolution** : correction déployée et validée (clôture du ticket après validation par la maîtrise d'ouvrage / service utilisateur, selon le circuit applicable).

## 6.7. Qualité et amélioration continue

Notre approche de maintenance corrective intègre une démarche d'amélioration continue :

**Analyse des causes profondes** : au-delà de la correction immédiate, nous analysons les causes profondes des anomalies pour identifier :
- Les points de fragilité de l'application
- Les opportunités d'amélioration technique
- Les besoins éventuels de documentation complémentaire

**Capitalisation** : nous alimentons une base de connaissances interne documentant :
- Les anomalies corrigées et leurs solutions
- Les points de vigilance identifiés
- Les bonnes pratiques de maintenance spécifiques à AQUAREEL

**Retour d'expérience (RCA) sur incidents critiques** : pour toute anomalie bloquante ou majeure dont la cause est non triviale, le titulaire produit une synthèse (cause racine, correction, actions préventives) et met à jour la documentation et/ou les tests de non‑régression correspondants. Ce retour est partagé lors des points de suivi / COPIL (cf. Annexe A.5).

**Bilan annuel** : lors de la réunion annuelle de suivi prévue au CCTP, nous présentons :
- Le bilan des anomalies traitées (volumétrie, délais, criticité)
- L'analyse des tendances
- Les propositions d'actions préventives (évolutions techniques, amélioration de la documentation, formations)

À titre indicatif, les éléments de Questions/Réponses du DCE (08/12/2025) mentionnent, hors recette et principalement en garantie, les volumes suivants :

| Type | 2023 | 2024 | 2025 |
|------|------|------|------|
| Bloquantes | 0 | 5 | 1 |
| Majeures | 11 | 12 | 8 |
| Mineures | 23 | 16 | 16 |

Cette approche structurée et rigoureuse contribue à la stabilité et à la fiabilité d'AQUAREEL, application critique au service de la prévision des crues et de la sécurité civile.
